{"version":3,"sources":["webpack:///./node_modules/@wpackio/entrypoint/lib/index.js","webpack:///./assets/scripts/focalpoint.js"],"names":["path","replace","window","concat","$","jQuery","document","ready","$image","$imageFocal","$imageFocalWrapper","$imageFocalPoint","startDragFocalPoint","e","addClass","draggingFocalPoint","console","log","target","endDragFocalPoint","removeClass","dragOverFocalPoint","stopPropagation","preventDefault","dropFocalPoint","position","initTemplates","element","selectView","wp","media","template","selectParent","find","selectImage","width","height","on","currentTarget","prepend","prependTo","saveView","saveParent","append","initFocalPoint","attachment","x","y","compat","get","item","focalPointX","val","focalPointY","css","left","top","display","TwoColumn","view","Attachment","Details","extend","initialize","this","model","change","render","prototype","apply","arguments","type","attributes","$el"],"mappings":";;;;;;;;;;;;;mKASgB,IAAIA,EAAK,qBAA6CC,QAAQ,kBAAkB,IAChG,IAAwBC,OAAO,YAAYC,OAAOH,K,cCVlD,IAAUI,KA0IPC,QAzIAC,UAAUC,OAAM,WACjB,IAAIC,EACAC,EACAC,EACAC,EAGEC,EAAsB,SAAAC,GAC3BJ,EAAYK,SAAS,gBAGhBC,EAAqB,SAAAF,GAC1BG,QAAQC,IAAI,qBAAsBJ,EAAEK,SAG/BC,EAAoB,SAAAN,GACzBJ,EAAYW,YAAY,gBAGnBC,EAAqB,SAAAR,GAC1BA,EAAES,kBACFT,EAAEU,kBAGGC,EAAiB,SAAAX,GACtBA,EAAES,kBACFT,EAAEU,iBACFP,QAAQC,IAAI,iBAAkBN,EAAiBc,aAqC1CC,EAAgB,SAAAC,GAErB,IAAIC,EAAeC,GAAGC,MAAMC,SAAS,iCACjCC,EAAeL,EAAQM,KAAK,cAC5BC,EAAeP,EAAQM,KAAK,kBAChCjB,QAAQC,IAAIiB,EAAYC,QAASD,EAAYE,UAC7CF,EAAYG,GAAG,QAAQ,SAAAxB,GACtBG,QAAQC,IAAIb,EAAES,EAAEyB,eAAeH,QAAS/B,EAAES,EAAEyB,eAAeF,aAGxDR,IACHI,EAAaO,QAAQX,GAErBnB,EAAuBkB,EAAQM,KAAK,gBACpCvB,EAAuBiB,EAAQM,KAAK,yBACpCtB,EAAuBgB,EAAQM,KAAK,uBACbN,EAAQM,KAAK,2BACpCC,EAAYM,UAAU9B,GACtBF,EAAuBE,EAAmBuB,KAAK,mBAIhD,IAAIQ,EAAaZ,GAAGC,MAAMC,SAAS,+BAC/BW,EAAaf,EAAQM,KAAK,uBAC1BQ,GACHC,EAAWC,OAAOF,IAOdG,EAAiB,SAAAC,GACtB,IA1D2BC,EAAGC,EA0DxBC,EAASH,EAAWI,IAAI,UAE9B,GAAID,EAAOE,KAAM,CAChB,IAAMC,EAAc/C,EAAE4C,EAAOE,MAAMjB,KAAK,qDAAqDmB,MACvFC,EAAcjD,EAAE4C,EAAOE,MAAMjB,KAAK,qDAAqDmB,MA9DnEN,EAgEPK,EAhEUJ,EAgEGM,EA/DjCrC,QAAQC,IAAIT,EAAQA,EAAO2B,QAAS3B,EAAO4B,UAE3C1B,EAAmB4C,IAAI,CACtBnB,MAAO3B,EAAO2B,QACdC,OAAQ5B,EAAO4B,WAGhBzB,EAAiB2C,IAAI,CACpBC,KAAK,GAAD,OAAKT,EAAL,KACJU,IAAI,GAAD,OAAKT,EAAL,KACHU,QAAS,UAIV/C,EAAmB2B,GAAG,WAAYhB,GAClCX,EAAmB2B,GAAG,OAAQb,GAC9Bb,EAAiB0B,GAAG,YAAazB,GACjCD,EAAiB0B,GAAG,OAAQtB,GAC5BJ,EAAiB0B,GAAG,UAAWlB,KAoD5BuC,EAAY7B,GAAGC,MAAM6B,KAAKC,WAAWC,QAAQH,UACjD7B,GAAGC,MAAM6B,KAAKC,WAAWC,QAAQH,UAAYA,EAAUI,OAAO,CAC7DC,WAAY,WAEXC,KAAKC,MAAM5B,GAAG,gBAAiB2B,KAAKE,OAAQF,OAE7CG,OAAQ,WAEPtC,GAAGC,MAAM6B,KAAKC,WAAWQ,UAAUD,OAAOE,MAAML,KAAMM,WAFpC,IAIVC,EAASP,KAAKC,MAAMO,WAApBD,KAMR,MALa,UAATA,IACH7C,EAAcsC,KAAKS,KACnB7B,EAAeoB,KAAKC,QAGdD,MAERE,OAAQ,WAGM,UADIF,KAAKC,MAAMO,WAApBD,MAEP3B,EAAeoB,KAAKC,c","file":"focalpoint/admin-0b573cb6.js","sourcesContent":["/* eslint-disable camelcase */ /* eslint-disable babel/camelcase */ /* eslint-disable no-underscore-dangle */ // eslint-disable-next-line no-unused-vars\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\n/* global __webpack_public_path__ */ // eslint-disable-next-line spaced-comment\n///<reference types=\"webpack-env\" />\n// We expect __webpack_public_path__ to be present, thanks to webpack\n// We are not using DOM in the typescript library, so let's just hack our way\n// through window\n// tslint:disable-next-line:no-any\n// We would override __webpack_public_path__ only if __WPACKIO__ webpack plugin is set\nif(__WPACKIO__){var path=(__WPACKIO__.appName+__WPACKIO__.outputPath).replace(/[^a-zA-Z0-9_-]/g,'');// eslint-disable-next-line no-global-assign\n__webpack_public_path__=window[\"__wpackIo\".concat(path)];}","(function($) {\n\t$(document).ready(() => {\n\t\tlet $image;\n\t\tlet $imageFocal;\n\t\tlet $imageFocalWrapper;\n\t\tlet $imageFocalPoint;\n\t\tlet $imageFocalClickarea;\n\n\t\tconst startDragFocalPoint = e => {\n\t\t\t$imageFocal.addClass('is-dragging');\n\t\t};\n\n\t\tconst draggingFocalPoint = e => {\n\t\t\tconsole.log('draggingFocalPoint', e.target);\n\t\t};\n\n\t\tconst endDragFocalPoint = e => {\n\t\t\t$imageFocal.removeClass('is-dragging');\n\t\t};\n\n\t\tconst dragOverFocalPoint = e => {\n\t\t\te.stopPropagation();\n\t\t\te.preventDefault();\n\t\t};\n\n\t\tconst dropFocalPoint = e => {\n\t\t\te.stopPropagation();\n\t\t\te.preventDefault();\n\t\t\tconsole.log('dropFocalPoint', $imageFocalPoint.position());\n\n\t\t\t// $imageFocalPoint.css({\n\t\t\t// \tleft: `${x}%`,\n\t\t\t// \ttop: `${y}%`,\n\t\t\t// \tdisplay: 'block'\n\t\t\t// });\n\t\t};\n\n\t\t/*\n\t\t * Init Focus Interface\n\t\t */\n\t\tconst initFocusInterface = (x, y) => {\n\t\t\tconsole.log($image, $image.width(), $image.height());\n\n\t\t\t$imageFocalWrapper.css({\n\t\t\t\twidth: $image.width(),\n\t\t\t\theight: $image.height()\n\t\t\t});\n\n\t\t\t$imageFocalPoint.css({\n\t\t\t\tleft: `${x}%`,\n\t\t\t\ttop: `${y}%`,\n\t\t\t\tdisplay: 'block'\n\t\t\t});\n\n\t\t\t// Drag'n drop events\n\t\t\t$imageFocalWrapper.on('dragover', dragOverFocalPoint);\n\t\t\t$imageFocalWrapper.on('drop', dropFocalPoint);\n\t\t\t$imageFocalPoint.on('dragstart', startDragFocalPoint);\n\t\t\t$imageFocalPoint.on('drag', draggingFocalPoint);\n\t\t\t$imageFocalPoint.on('dragend', endDragFocalPoint);\n\t\t};\n\n\t\t/*\n\t\t * Init templates\n\t\t */\n\t\tconst initTemplates = element => {\n\t\t\t// Append focal point selector\n\t\t\tvar selectView   = wp.media.template('attachment-select-focal-point');\n\t\t\tvar selectParent = element.find('.thumbnail');\n\t\t\tvar selectImage  = element.find('.details-image');\n\t\t\tconsole.log(selectImage.width(), selectImage.height());\n\t\t\tselectImage.on('load', e => {\n\t\t\t\tconsole.log($(e.currentTarget).width(), $(e.currentTarget).height());\n\t\t\t});\n\n\t\t\tif (selectView) {\n\t\t\t\tselectParent.prepend(selectView);\n\t\t\t\t// Set image focal elements\n\t\t\t\t$imageFocal          = element.find('.image-focal');\n\t\t\t\t$imageFocalWrapper   = element.find('.image-focal__wrapper');\n\t\t\t\t$imageFocalPoint     = element.find('.image-focal__point');\n\t\t\t\t$imageFocalClickarea = element.find('.image-focal__clickarea');\n\t\t\t\tselectImage.prependTo($imageFocalWrapper);\n\t\t\t\t$image               = $imageFocalWrapper.find('.details-image');\n\t\t\t}\n\n\t\t\t// Append focal point save button\n\t\t\tvar saveView   = wp.media.template('attachment-save-focal-point');\n\t\t\tvar saveParent = element.find('.attachment-actions');\n\t\t\tif (saveView) {\n\t\t\t\tsaveParent.append(saveView);\n\t\t\t}\n\t\t};\n\n\t\t/*\n\t\t * Init Focal Point\n\t\t */\n\t\tconst initFocalPoint = attachment => {\n\t\t\tconst compat = attachment.get('compat');\n\n\t\t\tif (compat.item) {\n\t\t\t\tconst focalPointX = $(compat.item).find('.compat-field-responsive_pics_focal_point_x input').val();\n\t\t\t\tconst focalPointY = $(compat.item).find('.compat-field-responsive_pics_focal_point_y input').val();\n\n\t\t\t\tinitFocusInterface(focalPointX, focalPointY);\n\t\t\t}\n\t\t};\n\n\t\t/*\n\t\t * Extend Attachment view\n\t\t */\n\t\tvar TwoColumn = wp.media.view.Attachment.Details.TwoColumn;\n\t\twp.media.view.Attachment.Details.TwoColumn = TwoColumn.extend({\n\t\t\tinitialize: function() {\n\t\t\t\t// Always make sure that our content is up to date.\n\t\t\t\tthis.model.on('change:compat', this.change, this);\n\t\t\t},\n\t\t\trender: function() {\n\t\t\t\t// Ensure that the main view is rendered.\n\t\t\t\twp.media.view.Attachment.prototype.render.apply(this, arguments);\n\t\t\t\t// Init focal point for images\n\t\t\t\tconst { type } = this.model.attributes;\n\t\t\t\tif (type === 'image') {\n\t\t\t\t\tinitTemplates(this.$el);\n\t\t\t\t\tinitFocalPoint(this.model);\n\t\t\t\t}\n\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tchange: function() {\n\t\t\t\t// Re-init focal point for images\n\t\t\t\tconst { type } = this.model.attributes;\n\t\t\t\tif (type === 'image') {\n\t\t\t\t\tinitFocalPoint(this.model);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t});\n})(jQuery);\n"],"sourceRoot":""}