{"version":3,"sources":["webpack:///./node_modules/@wpackio/entrypoint/lib/index.js","webpack:///./assets/scripts/focalpoint.js"],"names":["path","replace","window","concat","$","$imageFocalWrapper","$imageFocalPoint","$imageFocalClickarea","$imageFocalSave","Focal","jQuery","init","focalPoint","wrapper","picker","point","x","y","positionFocalPoint","setEventListeners","on","setFocalPoint","draggable","cursor","start","startDrag","drag","dragging","stop","stopDrag","containment","position","css","left","top","e","pointYOffset","offsetY","height","pointXOffset","offsetX","width","Math","round","console","log","addClass","removeClass","target","offsetLeft","offsetTop","document","ready","initTemplates","element","selectView","wp","media","template","selectParent","find","selectImage","prepend","prependTo","$image","saveView","saveParent","append","getFocalPoint","attachment","compat","get","item","val","updateFocusInterface","initFocusInterface","TwoColumn","view","Attachment","Details","extend","initialize","this","model","change","render","prototype","apply","arguments","type","attributes","$el"],"mappings":"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","file":"focalpoint/admin-9f84c612.js","sourcesContent":["/* eslint-disable camelcase */ /* eslint-disable babel/camelcase */ /* eslint-disable no-underscore-dangle */ // eslint-disable-next-line no-unused-vars\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\n/* global __webpack_public_path__ */ // eslint-disable-next-line spaced-comment\n///<reference types=\"webpack-env\" />\n// We expect __webpack_public_path__ to be present, thanks to webpack\n// We are not using DOM in the typescript library, so let's just hack our way\n// through window\n// tslint:disable-next-line:no-any\n// We would override __webpack_public_path__ only if __WPACKIO__ webpack plugin is set\nif(__WPACKIO__){var path=(__WPACKIO__.appName+__WPACKIO__.outputPath).replace(/[^a-zA-Z0-9_-]/g,'');// eslint-disable-next-line no-global-assign\n__webpack_public_path__=window[\"__wpackIo\".concat(path)];}","(function($) {\n\t/**\n\t Set variables\n\t**/\n\tlet $imageFocal;\n\tlet $imageFocalWrapper;\n\tlet $imageFocalPoint;\n\tlet $imageFocalClickarea;\n\tlet $imageFocalSave;\n\n\t/**\n\t Small plugin to set the focal point of an image\n\t Source: https://codepen.io/vinsongrant/pen/QGodXV\n\t**/\n\tconst Focal = {\n\t\t/**\n\t\t Set variables\n\t\t**/\n\t\tinit: focalPoint => {\n\t\t\tFocal.wrapper = $imageFocalWrapper;\n\t\t\tFocal.picker = $imageFocalClickarea;\n\t\t\tFocal.point  = $imageFocalPoint;\n\t\t\tFocal.x = focalPoint.x;\n\t\t\tFocal.y = focalPoint.y;\n\t\t\tFocal.positionFocalPoint(focalPoint);\n\t\t\tFocal.setEventListeners();\n\t\t},\n\n\t\t/**\n\t\t Event Listeners\n\t\t**/\n\t\tsetEventListeners: () => {\n\t\t\tFocal.picker.on('click', Focal.setFocalPoint);\n\t\t\tFocal.point.draggable({\n\t\t\t\tcursor: 'move',\n\t\t\t\tstart: Focal.startDrag,\n\t\t\t\tdrag: Focal.dragging,\n\t\t\t\tstop: Focal.stopDrag,\n\t\t\t\tcontainment: Focal.wrapper\n\t\t\t});\n\t\t},\n\n\t\tpositionFocalPoint: position => {\n\t\t\tFocal.point.css({\n\t\t\t\tleft: `${position.x}%`,\n\t\t\t\ttop: `${position.y}%`\n\t\t\t});\n\t\t},\n\n\t\tsetFocalPoint: e => {\n\t\t\tvar pointYOffset = e.offsetY - Focal.point.height() / 2,\n\t\t\t\tpointXOffset = e.offsetX - Focal.point.width() / 2;\n\n\t\t\tFocal.x = Math.round(pointXOffset / Focal.picker.width() * 100);\n\t\t\tFocal.y = Math.round(pointYOffset / Focal.picker.height() * 100);\n\n\t\t\tconsole.log(pointXOffset, Focal.x, pointYOffset, Focal.y);\n\n\t\t\tFocal.point.css({\n\t\t\t\tleft: `${Focal.x}%`,\n\t\t\t\ttop: `${Focal.y}%`\n\t\t\t});\n\t\t},\n\n\t\tstartDrag: e => {\n\t\t\t$('body').addClass('focal-point-dragging');\n\t\t\t$imageFocalSave.removeClass('button-disabled');\n\t\t},\n\n\t\tdragging: e => {\n\t\t\tFocal.x = Math.round(e.target.offsetLeft / Focal.picker.width() * 100);\n\t\t\tFocal.y = Math.round(e.target.offsetTop / Focal.picker.height() * 100);\n\t\t},\n\n\t\tstopDrag: e => {\n\t\t\t$('body').removeClass('focal-point-dragging');\n\t\t\tFocal.point.css({\n\t\t\t\tleft: `${Focal.x}%`,\n\t\t\t\ttop: `${Focal.y}%`\n\t\t\t});\n\t\t}\n\t};\n\n\t$(document).ready(() => {\n\t\t/**\n\t\t * Init templates\n\t\t */\n\t\tconst initTemplates = element => {\n\t\t\t// Append focal point selector\n\t\t\tconst selectView   = wp.media.template('attachment-select-focal-point');\n\t\t\tconst selectParent = element.find('.thumbnail');\n\t\t\tconst selectImage  = element.find('.details-image');\n\n\t\t\tif (selectView) {\n\t\t\t\tselectParent.prepend(selectView);\n\t\t\t\t// Set image focal elements\n\t\t\t\t$imageFocal          = element.find('.image-focal');\n\t\t\t\t$imageFocalWrapper   = element.find('.image-focal__wrapper');\n\t\t\t\t$imageFocalPoint     = element.find('.image-focal__point');\n\t\t\t\t$imageFocalClickarea = element.find('.image-focal__clickarea');\n\t\t\t\tselectImage.prependTo($imageFocalWrapper);\n\t\t\t\t$image               = $imageFocalWrapper.find('.details-image');\n\t\t\t}\n\n\t\t\t// Append focal point save button\n\t\t\tconst saveView   = wp.media.template('attachment-save-focal-point');\n\t\t\tconst saveParent = element.find('.attachment-actions');\n\t\t\tif (saveView) {\n\t\t\t\tsaveParent.append(saveView);\n\t\t\t\t$imageFocalSave = element.find('button.save-attachment-focal-point');\n\t\t\t}\n\t\t};\n\n\t\t/**\n\t\t * Get Focal Point from meta fields\n\t\t */\n\t\tconst getFocalPoint = attachment => {\n\t\t\tconst compat = attachment.get('compat');\n\n\t\t\tif (compat.item) {\n\t\t\t\tconst focalPointX = $(compat.item).find('.compat-field-responsive_pics_focal_point_x input').val();\n\t\t\t\tconst focalPointY = $(compat.item).find('.compat-field-responsive_pics_focal_point_y input').val();\n\n\t\t\t\treturn {\n\t\t\t\t\tx: focalPointX,\n\t\t\t\t\ty: focalPointY\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn;\n\t\t};\n\n\t\t/**\n\t\t * Update Focus Interface\n\t\t */\n\t\tconst updateFocusInterface = () => {\n\t\t\t$imageFocalWrapper.css({\n\t\t\t\twidth: `${$image.width()}px`\n\t\t\t});\n\t\t};\n\n\t\t/**\n\t\t * Init Focus Interface\n\t\t */\n\t\tconst initFocusInterface = attachment => {\n\t\t\tconst focalPoint = getFocalPoint(attachment);\n\n\t\t\t$image.on('load', e => {\n\t\t\t\tupdateFocusInterface();\n\t\t\t\tFocal.init(focalPoint);\n\t\t\t});\n\n\t\t\t$(window).on('resize', updateFocusInterface);\n\t\t};\n\n\t\t/**\n\t\t * Extend Attachment view\n\t\t */\n\t\tvar TwoColumn = wp.media.view.Attachment.Details.TwoColumn;\n\t\twp.media.view.Attachment.Details.TwoColumn = TwoColumn.extend({\n\t\t\t// Always make sure that our content is up to date.\n\t\t\tinitialize: function() {\n\t\t\t\tthis.model.on('change:compat', this.change, this);\n\t\t\t},\n\t\t\t// Init focal point for images\n\t\t\trender: function() {\n\t\t\t\twp.media.view.Attachment.prototype.render.apply(this, arguments);\n\t\t\t\tconst { type } = this.model.attributes;\n\t\t\t\tif (type === 'image') {\n\t\t\t\t\tinitTemplates(this.$el);\n\t\t\t\t\tinitFocusInterface(this.model);\n\t\t\t\t}\n\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\t// Re-init focal point for images\n\t\t\tchange: function() {\n\t\t\t\tconst { type } = this.model.attributes;\n\t\t\t\tif (type === 'image') {\n\t\t\t\t\tfocalPoint = getFocalPoint(this.model);\n\t\t\t\t\tFocal.x = focalPoint.x;\n\t\t\t\t\tFocal.y = focalPoint.y;\n\t\t\t\t\tFocal.positionFocalPoint(focalPoint);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t});\n})(jQuery);\n"],"sourceRoot":""}