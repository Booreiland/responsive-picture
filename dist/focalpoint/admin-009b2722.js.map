{"version":3,"sources":["webpack:///./node_modules/@wpackio/entrypoint/lib/index.js","webpack:///./assets/scripts/focal-point-admin.js"],"names":["path","replace","window","concat","$","_view","$image","$imageFocalWrapper","$imageFocalPoint","$imageFocalClickarea","$imageFocalSave","Focal","jQuery","init","focalPoint","wrapper","picker","point","position","positionFocalPoint","setEventListeners","on","setFocalPoint","ui","draggable","cursor","start","startDrag","drag","dragging","stop","stopDrag","containment","css","left","x","top","y","e","removeAttr","pointYOffset","offsetY","height","pointXOffset","offsetX","width","Number","toFixed","addClass","target","offsetLeft","offsetTop","removeClass","model","set","document","ready","initAttachmentDetails","element","id","selectView","wp","media","template","selectParent","find","selectImage","length","prepend","prependTo","saveView","saveParent","append","initImageEditor","imageEditor","updateFocusInterface","initFocusInterface","attachment","get","preventDefault","ajax","url","settings","method","data","action","attributes","done","update","fail","jqXHR","textStatus","console","log","always","attr","saveFocalPoint","changeView","view","type","EditImage","Attachment","TwoColumnView","Details","TwoColumn","AttachmentDetails","EditImageDetailsView","extend","initialize","this","change","render","prototype","apply","arguments","$el","views","detach","fetch","options","frame","loadEditor","one","imageLoaded","off","back","content","mode","editorLoaded","updateAll"],"mappings":"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","file":"focalpoint/admin-009b2722.js","sourcesContent":["/* eslint-disable camelcase */ /* eslint-disable babel/camelcase */ /* eslint-disable no-underscore-dangle */ // eslint-disable-next-line no-unused-vars\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\n/* global __webpack_public_path__ */ // eslint-disable-next-line spaced-comment\n///<reference types=\"webpack-env\" />\n// We expect __webpack_public_path__ to be present, thanks to webpack\n// We are not using DOM in the typescript library, so let's just hack our way\n// through window\n// tslint:disable-next-line:no-any\n// We would override __webpack_public_path__ only if __WPACKIO__ webpack plugin is set\nif(__WPACKIO__){var path=(__WPACKIO__.appName+__WPACKIO__.outputPath).replace(/[^a-zA-Z0-9_-]/g,'');// eslint-disable-next-line no-global-assign\n__webpack_public_path__=window[\"__wpackIo\".concat(path)];}","(function($) {\n\t/**\n\t Global variables\n\t**/\n\tlet _view;\n\tlet $image;\n\tlet $imageFocal;\n\tlet $imageFocalWrapper;\n\tlet $imageFocalPoint;\n\tlet $imageFocalClickarea;\n\tlet $imageFocalSave;\n\n\t/**\n\t Focal\n\t**/\n\tconst Focal = {\n\t\t/**\n\t\t Set variables\n\t\t**/\n\t\tinit: focalPoint => {\n\t\t\tFocal.wrapper  = $imageFocalWrapper;\n\t\t\tFocal.picker   = $imageFocalClickarea;\n\t\t\tFocal.point    = $imageFocalPoint;\n\t\t\tFocal.position = focalPoint;\n\t\t\tFocal.positionFocalPoint(focalPoint);\n\t\t\tFocal.setEventListeners();\n\t\t},\n\n\t\t/**\n\t\t Event Listeners\n\t\t**/\n\t\tsetEventListeners: () => {\n\t\t\tFocal.picker.on('click', Focal.setFocalPoint);\n\n\t\t\t// Check if jQuery UI Draggable widget is active\n\t\t\tif (typeof($.ui.draggable) === 'function') {\n\t\t\t\tFocal.point.draggable({\n\t\t\t\t\tcursor: 'move',\n\t\t\t\t\tstart: Focal.startDrag,\n\t\t\t\t\tdrag: Focal.dragging,\n\t\t\t\t\tstop: Focal.stopDrag,\n\t\t\t\t\tcontainment: Focal.wrapper\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\n\t\tpositionFocalPoint: position => {\n\t\t\tFocal.point.css({\n\t\t\t\tleft: `${position.x}%`,\n\t\t\t\ttop: `${position.y}%`,\n\t\t\t\tposition: 'absolute'\n\t\t\t});\n\t\t},\n\n\t\tsetFocalPoint: e => {\n\t\t\t$imageFocalSave.removeAttr('disabled');\n\n\t\t\tconst pointYOffset = e.offsetY - Focal.point.height() / 2;\n\t\t\tconst pointXOffset = e.offsetX - Focal.point.width() / 2;\n\n\t\t\t// Convert absolute coordinates to percentages\n\t\t\tFocal.position.x = Number(pointXOffset / Focal.picker.width() * 100).toFixed(2);\n\t\t\tFocal.position.y = Number(pointYOffset / Focal.picker.height() * 100).toFixed(2);\n\n\t\t\tFocal.positionFocalPoint(Focal.position);\n\t\t},\n\n\t\tstartDrag: e => {\n\t\t\t$('body').addClass('focal-point-dragging');\n\t\t\t$imageFocalSave.removeAttr('disabled');\n\t\t},\n\n\t\tdragging: e => {\n\t\t\tFocal.position.x = Number(e.target.offsetLeft / Focal.picker.width() * 100).toFixed(2);\n\t\t\tFocal.position.y = Number(e.target.offsetTop / Focal.picker.height() * 100).toFixed(2);\n\t\t},\n\n\t\tstopDrag: e => {\n\t\t\t$('body').removeClass('focal-point-dragging');\n\t\t\tFocal.positionFocalPoint(Focal.position);\n\t\t\t_view.model.set('focalPoint', Focal.position);\n\t\t}\n\t};\n\n\t$(document).ready(() => {\n\t\t/**\n\t\t * Attachment Details\n\t\t */\n\t\tconst initAttachmentDetails = (element, id) => {\n\t\t\t// Append focal point selector\n\t\t\tconst selectView   = wp.media.template('attachment-details-focal-point');\n\t\t\tconst selectParent = element.find('.thumbnail');\n\t\t\tconst selectImage  = selectParent.find('img');\n\n\t\t\tif (selectView && selectParent.length && selectImage.length) {\n\t\t\t\tselectParent.prepend(selectView);\n\t\t\t\t// Set image focal elements\n\t\t\t\t$imageFocal          = element.find('.image-focal');\n\t\t\t\t$imageFocalWrapper   = element.find('.image-focal__wrapper');\n\t\t\t\t$imageFocalPoint     = element.find('.image-focal__point');\n\t\t\t\t$imageFocalClickarea = element.find('.image-focal__clickarea');\n\t\t\t\tselectImage.prependTo($imageFocalWrapper);\n\t\t\t\t$image               = $imageFocalWrapper.find('img');\n\t\t\t}\n\n\t\t\t// Append focal point save button\n\t\t\tconst saveView   = wp.media.template('attachment-save-focal-point');\n\t\t\tconst saveParent = element.find('.attachment-actions');\n\t\t\tif (saveView) {\n\t\t\t\tsaveParent.append(saveView);\n\t\t\t\t$imageFocalSave = element.find('button.save-attachment-focal-point');\n\t\t\t}\n\t\t};\n\n\t\t/**\n\t\t * Image Editor\n\t\t */\n\t\tconst initImageEditor = (element, id) => {\n\t\t\t// Append focal point selector\n\t\t\tconst selectView   = wp.media.template('image-edit-focal-point');\n\t\t\tconst imageEditor  = $('.media-frame-content .image-editor');\n\t\t\tconst selectParent = imageEditor.find(`#imgedit-crop-${id}`);\n\n\t\t\tif (selectView && selectParent.length) {\n\t\t\t\tselectParent.append(selectView);\n\t\t\t\t// Set image focal elements\n\t\t\t\t$imageFocalWrapper   = selectParent;\n\t\t\t\t$imageFocalPoint     = imageEditor.find('.image-focal__point');\n\t\t\t\t$imageFocalClickarea = imageEditor.find('.image-focal__clickarea');\n\t\t\t\t$image               = $imageFocalWrapper.find('img');\n\t\t\t}\n\n\t\t\t// Append focal point save button\n\t\t\tconst saveView   = wp.media.template('attachment-save-focal-point');\n\t\t\tconst saveParent = imageEditor.find('.imgedit-submit');\n\t\t\tif (saveView) {\n\t\t\t\tsaveParent.append(saveView);\n\t\t\t\t$imageFocalSave = imageEditor.find('button.save-attachment-focal-point');\n\t\t\t}\n\t\t};\n\n\t\t/**\n\t\t * Save Focal Point\n\t\t */\n\t\tconst saveFocalPoint = attachment => {\n\t\t\tconst focalPoint = {\n\t\t\t\tx: Focal.position.x,\n\t\t\t\ty: Focal.position.y\n\t\t\t};\n\n\t\t\t$.ajax({\n\t\t\t\turl: wp?.ajax?.settings?.url,\n\t\t\t\tmethod: 'POST',\n\t\t\t\tdata: {\n\t\t\t\t\taction: 'save_focal_point',\n\t\t\t\t\tattachment: attachment?.attributes\n\t\t\t\t}\n\t\t\t})\n\t\t\t// Update view on succesfull save\n\t\t\t.done(data => {\n\t\t\t\t_view.update();\n\t\t\t})\n\t\t\t.fail((jqXHR, textStatus) => {\n\t\t\t\tconsole.log('save focal point error', jqXHR);\n\t\t\t})\n\t\t\t.always(() => {\n\t\t\t\t$imageFocalSave.attr('disabled', 'disabled');\n\t\t\t});\n\t\t};\n\n\t\t/**\n\t\t * Update Focus Interface\n\t\t */\n\t\tconst updateFocusInterface = () => {\n\t\t\t$imageFocalWrapper.css({\n\t\t\t\twidth: `${$image.width()}px`\n\t\t\t});\n\t\t};\n\n\t\t/**\n\t\t * Init Focus Interface\n\t\t */\n\t\tconst initFocusInterface = attachment => {\n\t\t\tconst focalPoint = attachment.get('focalPoint');\n\t\t\tFocal.init(focalPoint);\n\n\t\t\t// Layout change\n\t\t\t$(window).on('resize', updateFocusInterface);\n\t\t\t$image.on('load', e => {\n\t\t\t\tupdateFocusInterface();\n\t\t\t\tFocal.init(focalPoint);\n\t\t\t});\n\n\t\t\t// Save button\n\t\t\t$imageFocalSave.on('click', e => {\n\t\t\t\te.preventDefault();\n\t\t\t\tsaveFocalPoint(attachment);\n\t\t\t});\n\t\t};\n\n\t\t/**\n\t\t * Extended view changed\n\t\t */\n\t\tconst changeView = view => {\n\t\t\tconst type       = view.model.get('type');\n\t\t\tconst focalPoint = view.model.get('focalPoint');\n\n\t\t\tif (type === 'image') {\n\t\t\t\tFocal.position = focalPoint;\n\t\t\t\tFocal.positionFocalPoint(focalPoint);\n\t\t\t}\n\t\t};\n\n\t\tconst EditImage = wp.media.view.EditImage;\n\t\tconst Attachment = wp.media.view.Attachment;\n\t\tconst TwoColumnView = wp.media.view.Attachment.Details.TwoColumn;\n\t\tconst AttachmentDetails = wp.media.view.Attachment.Details;\n\t\tconst EditImageDetailsView = wp.media.view.EditImage.Details;\n\n\t\t/**\n\t\t * Extend Attachment Details TwoColumn view (Media Library Modal)\n\t\t */\n\t\tif (TwoColumnView) {\n\t\t\twp.media.view.Attachment.Details.TwoColumn = TwoColumnView.extend({\n\t\t\t\t// Add focalPoint change listener\n\t\t\t\tinitialize: function() {\n\t\t\t\t\t_view = this;\n\t\t\t\t\tthis.model.on('change:focalPoint', this.change, this);\n\t\t\t\t},\n\t\t\t\t// Init extended template\n\t\t\t\trender: function() {\n\t\t\t\t\tAttachment.prototype.render.apply(this, arguments);\n\t\t\t\t\tconst id   = this.model.get('id');\n\t\t\t\t\tconst type = this.model.get('type');\n\n\t\t\t\t\tif (type === 'image') {\n\t\t\t\t\t\tinitAttachmentDetails(this.$el, id);\n\t\t\t\t\t\tinitFocusInterface(this.model);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t// Re-init focal point on input change\n\t\t\t\tchange: function() {\n\t\t\t\t\tchangeView(this);\n\t\t\t\t},\n\t\t\t\t// Update view on focal point js change\n\t\t\t\tupdate: function() {\n\t\t\t\t\tthis.views.detach();\n\t\t\t\t\tthis.model.fetch();\n\t\t\t\t\tthis.views.render();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\t/**\n\t\t * Extend EditImage Details view (Media Library Modal - Edit Image)\n\t\t */\n\t\tif (EditImageDetailsView) {\n\t\t\twp.media.view.EditImage.Details = EditImageDetailsView.extend({\n\t\t\t\t// Add focalPoint change listener\n\t\t\t\tinitialize: function(options) {\n\t\t\t\t\t_view = this;\n\t\t\t\t\tthis.frame  = options.frame;\n\t\t\t\t\tEditImage.prototype.initialize.apply(this, arguments);\n\t\t\t\t\tthis.model.on('change:focalPoint', this.change, this);\n\t\t\t\t},\n\t\t\t\t// Editor loaded\n\t\t\t\tloadEditor: function() {\n\t\t\t\t\tEditImage.prototype.loadEditor.apply(this, arguments);\n\t\t\t\t\t$(document).one('image-editor-ui-ready', this.imageLoaded);\n\t\t\t\t},\n\t\t\t\t// Editor image loaded\n\t\t\t\timageLoaded: function() {\n\t\t\t\t\t$(document).off('image-editor-ui-ready', this.imageLoaded);\n\t\t\t\t\tconst id   = _view.model.get('id');\n\t\t\t\t\tconst type = _view.model.get('type');\n\n\t\t\t\t\tif (type === 'image') {\n\t\t\t\t\t\tinitImageEditor(_view.$el, id);\n\t\t\t\t\t\tinitFocusInterface(_view.model);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t// Cancel button\n\t\t\t\tback: function() {\n\t\t\t\t\tthis.frame.content.mode('edit-metadata');\n\t\t\t\t},\n\t\t\t\t// Re-init focal point on input change\n\t\t\t\tchange: function() {\n\t\t\t\t\tchangeView(this);\n\t\t\t\t},\n\t\t\t\t// Update view on focal point js change\n\t\t\t\tupdate: function() {\n\t\t\t\t\tthis.views.detach();\n\t\t\t\t\tthis.model.fetch();\n\t\t\t\t\tthis.views.render();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\t/**\n\t\t * Extend Attachment Details view (Post Edit Modal)\n\t\t */\n\t\tif (AttachmentDetails) {\n\t\t\twp.media.view.Attachment.Details = AttachmentDetails.extend({\n\t\t\t\t// Add focalPoint change listener\n\t\t\t\tinitialize: function() {\n\t\t\t\t\t_view = this;\n\t\t\t\t\tAttachment.prototype.initialize.apply(this, arguments);\n\t\t\t\t\tthis.model.on('change:focalPoint', this.change, this);\n\t\t\t\t\t$(document).one('image-editor-ui-ready', this.editorLoaded);\n\t\t\t\t},\n\t\t\t\t// Init extended template\n\t\t\t\trender: function() {\n\t\t\t\t\tAttachment.prototype.render.apply(this, arguments);\n\t\t\t\t\tconst id   = this.model.get('id');\n\t\t\t\t\tconst type = this.model.get('type');\n\n\t\t\t\t\tif (type === 'image') {\n\t\t\t\t\t\tinitAttachmentDetails(this.$el, id);\n\t\t\t\t\t\tinitFocusInterface(this.model);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t// Editor image loaded\n\t\t\t\teditorLoaded: function() {\n\t\t\t\t\t$(document).off('image-editor-ui-ready', this.editorLoaded);\n\t\t\t\t\tconst id   = _view.model.get('id');\n\t\t\t\t\tconst type = _view.model.get('type');\n\n\t\t\t\t\tif (type === 'image') {\n\t\t\t\t\t\tinitImageEditor(_view.$el, id);\n\t\t\t\t\t\tinitFocusInterface(_view.model);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t// Re-init focal point on input change\n\t\t\t\tchange: function() {\n\t\t\t\t\tchangeView(this);\n\t\t\t\t},\n\t\t\t\t// Update view on focal point js change\n\t\t\t\tupdate: function() {\n\t\t\t\t\tconsole.log('AttachmentDetails update', this.model);\n\t\t\t\t\tthis.views.detach();\n\t\t\t\t\tthis.model.fetch();\n\t\t\t\t\tthis.views.render();\n\t\t\t\t},\n\t\t\t\t// On update image\n\t\t\t\tupdateAll: function() {\n\t\t\t\t\tconsole.log('AttachmentDetails updateAll', this.model);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t});\n})(jQuery);\n"],"sourceRoot":""}