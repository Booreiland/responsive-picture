{"version":3,"sources":["webpack:///./node_modules/@wpackio/entrypoint/lib/index.js","webpack:///./node_modules/@babel/runtime/helpers/esm/typeof.js","webpack:///./assets/scripts/focalpoint.js"],"names":["path","replace","window","concat","_typeof","obj","Symbol","iterator","constructor","prototype","$","$image","$imageFocalWrapper","$imageFocalPoint","$imageFocalClickarea","$imageFocalSave","Focal","jQuery","init","focalPoint","wrapper","picker","point","positionFocalPoint","setEventListeners","on","setFocalPoint","console","log","ui","draggable","cursor","start","startDrag","drag","dragging","stop","stopDrag","containment","position","x","y","css","left","top","e","removeClass","pointYOffset","offsetY","height","pointXOffset","offsetX","width","Number","toFixed","addClass","target","offsetLeft","offsetTop","document","ready","initTemplates","element","selectView","wp","media","template","selectParent","find","selectImage","prepend","prependTo","saveView","saveParent","append","updateFocusInterface","initFocusInterface","attachment","get","preventDefault","set","save","success","model","response","options","error","saveFocalPoint","TwoColumn","view","Attachment","Details","extend","initialize","this","change","render","apply","arguments","type","$el"],"mappings":"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","file":"focalpoint/admin-78a12064.js","sourcesContent":["/* eslint-disable camelcase */ /* eslint-disable babel/camelcase */ /* eslint-disable no-underscore-dangle */ // eslint-disable-next-line no-unused-vars\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\n/* global __webpack_public_path__ */ // eslint-disable-next-line spaced-comment\n///<reference types=\"webpack-env\" />\n// We expect __webpack_public_path__ to be present, thanks to webpack\n// We are not using DOM in the typescript library, so let's just hack our way\n// through window\n// tslint:disable-next-line:no-any\n// We would override __webpack_public_path__ only if __WPACKIO__ webpack plugin is set\nif(__WPACKIO__){var path=(__WPACKIO__.appName+__WPACKIO__.outputPath).replace(/[^a-zA-Z0-9_-]/g,'');// eslint-disable-next-line no-global-assign\n__webpack_public_path__=window[\"__wpackIo\".concat(path)];}","export default function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}","(function($) {\n\t/**\n\t Global variables\n\t**/\n\tlet $image;\n\tlet $imageFocal;\n\tlet $imageFocalWrapper;\n\tlet $imageFocalPoint;\n\tlet $imageFocalClickarea;\n\tlet $imageFocalSave;\n\n\t/**\n\t Focal\n\t**/\n\tconst Focal = {\n\t\t/**\n\t\t Set variables\n\t\t**/\n\t\tinit: focalPoint => {\n\t\t\tFocal.wrapper = $imageFocalWrapper;\n\t\t\tFocal.picker = $imageFocalClickarea;\n\t\t\tFocal.point  = $imageFocalPoint;\n\t\t\tFocal.positionFocalPoint(focalPoint);\n\t\t\tFocal.setEventListeners();\n\t\t},\n\n\t\t/**\n\t\t Event Listeners\n\t\t**/\n\t\tsetEventListeners: () => {\n\t\t\tFocal.picker.on('click', Focal.setFocalPoint);\n\t\t\tconsole.log(typeof($.ui.draggable));\n\n\t\t\tif (typeof($.ui.draggable) !== 'undefined'){\n\t\t\t\tFocal.point.draggable({\n\t\t\t\t\tcursor: 'move',\n\t\t\t\t\tstart: Focal.startDrag,\n\t\t\t\t\tdrag: Focal.dragging,\n\t\t\t\t\tstop: Focal.stopDrag,\n\t\t\t\t\tcontainment: Focal.wrapper\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\n\t\tpositionFocalPoint: position => {\n\t\t\tFocal.x = position.x;\n\t\t\tFocal.y = position.y;\n\n\t\t\tFocal.point.css({\n\t\t\t\tleft: `${position.x}%`,\n\t\t\t\ttop: `${position.y}%`\n\t\t\t});\n\t\t},\n\n\t\tsetFocalPoint: e => {\n\t\t\t$imageFocalSave.removeClass('button-disabled');\n\n\t\t\tvar pointYOffset = e.offsetY - Focal.point.height() / 2,\n\t\t\t\tpointXOffset = e.offsetX - Focal.point.width() / 2;\n\n\t\t\t// Convert absolute coordinates to percentages\n\t\t\tFocal.x = Number(pointXOffset / Focal.picker.width() * 100).toFixed(2);\n\t\t\tFocal.y = Number(pointYOffset / Focal.picker.height() * 100).toFixed(2);\n\t\t\tFocal.positionFocalPoint(Focal);\n\t\t},\n\n\t\tstartDrag: e => {\n\t\t\t$('body').addClass('focal-point-dragging');\n\t\t\t$imageFocalSave.removeClass('button-disabled');\n\t\t},\n\n\t\tdragging: e => {\n\t\t\tFocal.x = Number(e.target.offsetLeft / Focal.picker.width() * 100).toFixed(2);\n\t\t\tFocal.y = Number(e.target.offsetTop / Focal.picker.height() * 100).toFixed(2);\n\t\t},\n\n\t\tstopDrag: e => {\n\t\t\t$('body').removeClass('focal-point-dragging');\n\t\t\tFocal.positionFocalPoint(Focal);\n\t\t}\n\t};\n\n\t$(document).ready(() => {\n\t\t/**\n\t\t * Init templates\n\t\t */\n\t\tconst initTemplates = element => {\n\t\t\t// Append focal point selector\n\t\t\tconst selectView   = wp.media.template('attachment-select-focal-point');\n\t\t\tconst selectParent = element.find('.thumbnail');\n\t\t\tconst selectImage  = element.find('.details-image');\n\n\t\t\tif (selectView) {\n\t\t\t\tselectParent.prepend(selectView);\n\t\t\t\t// Set image focal elements\n\t\t\t\t$imageFocal          = element.find('.image-focal');\n\t\t\t\t$imageFocalWrapper   = element.find('.image-focal__wrapper');\n\t\t\t\t$imageFocalPoint     = element.find('.image-focal__point');\n\t\t\t\t$imageFocalClickarea = element.find('.image-focal__clickarea');\n\t\t\t\tselectImage.prependTo($imageFocalWrapper);\n\t\t\t\t$image               = $imageFocalWrapper.find('.details-image');\n\t\t\t}\n\n\t\t\t// Append focal point save button\n\t\t\tconst saveView   = wp.media.template('attachment-save-focal-point');\n\t\t\tconst saveParent = element.find('.attachment-actions');\n\t\t\tif (saveView) {\n\t\t\t\tsaveParent.append(saveView);\n\t\t\t\t$imageFocalSave = element.find('button.save-attachment-focal-point');\n\t\t\t}\n\t\t};\n\n\t\t/**\n\t\t * Save Focal Point\n\t\t */\n\t\tconst saveFocalPoint = attachment => {\n\t\t\tconst focalPoint = {\n\t\t\t\tx: Focal.x,\n\t\t\t\ty: Focal.y\n\t\t\t};\n\n\t\t\tattachment.set('focalPoint', focalPoint);\n\t\t\tattachment.save('focalPoint', focalPoint, {\n\t\t\t\tsuccess: (model, response, options) => {\n\t\t\t\t\tconsole.log('save success', response);\n\t\t\t\t},\n\t\t\t\terror: (model, response, options) => {\n\t\t\t\t\tconsole.log('save error', response);\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\n\t\t/**\n\t\t * Update Focus Interface\n\t\t */\n\t\tconst updateFocusInterface = () => {\n\t\t\t$imageFocalWrapper.css({\n\t\t\t\twidth: `${$image.width()}px`\n\t\t\t});\n\t\t};\n\n\t\t/**\n\t\t * Init Focus Interface\n\t\t */\n\t\tconst initFocusInterface = attachment => {\n\t\t\tconst focalPoint = attachment.get('focalPoint');\n\n\t\t\t// Interface\n\t\t\t$(window).on('resize', updateFocusInterface);\n\t\t\t$image.on('load', e => {\n\t\t\t\tupdateFocusInterface();\n\t\t\t\tFocal.init(focalPoint);\n\t\t\t});\n\n\t\t\t// Save button\n\t\t\t$imageFocalSave.on('click', e => {\n\t\t\t\te.preventDefault();\n\t\t\t\tsaveFocalPoint(attachment);\n\t\t\t});\n\t\t};\n\n\t\t/**\n\t\t * Extend Attachment view\n\t\t */\n\t\tvar TwoColumn = wp.media.view.Attachment.Details.TwoColumn;\n\t\twp.media.view.Attachment.Details.TwoColumn = TwoColumn.extend({\n\t\t\t// Listen to focalPoint change\n\t\t\tinitialize: function() {\n\t\t\t\tthis.model.on('change:focalPoint', this.change, this);\n\t\t\t},\n\t\t\t// Init focal point for images\n\t\t\trender: function() {\n\t\t\t\twp.media.view.Attachment.prototype.render.apply(this, arguments);\n\t\t\t\tconst type = this.model.get('type');\n\n\t\t\t\tif (type === 'image') {\n\t\t\t\t\tinitTemplates(this.$el);\n\t\t\t\t\tinitFocusInterface(this.model);\n\t\t\t\t}\n\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\t// Re-init focal point for images\n\t\t\tchange: function() {\n\t\t\t\tconst type       = this.model.get('type');\n\t\t\t\tconst focalPoint = this.model.get('focalPoint');\n\t\t\t\tconsole.log('change:focalPoint', focalPoint);\n\n\t\t\t\tif (type === 'image') {\n\t\t\t\t\tFocal.positionFocalPoint(focalPoint);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t});\n})(jQuery);\n"],"sourceRoot":""}