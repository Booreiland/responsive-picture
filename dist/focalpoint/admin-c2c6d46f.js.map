{"version":3,"sources":["webpack:///./node_modules/@wpackio/entrypoint/lib/index.js","webpack:///./assets/scripts/focalpoint.js"],"names":["path","replace","window","concat","$","jQuery","document","ready","$imageFocal","$imageFocalWrapper","$imageFocalPoint","$imageFocalClickarea","offset","x","y","initTemplates","element","selectView","wp","media","template","selectParent","find","selectImg","prepend","prependTo","saveView","saveParent","append","startMove","t","e","pos","o","pageX","pageY","updateClickPosition","addClass","hover","val","toggleClass","initFocusInterface","css","left","top","display","on","which","move","removeClass","initFocalPoint","attachment","id","compat","get","item","focalPointX","focalPointY","TwoColumn","view","Attachment","Details","extend","initialize","this","model","change","render","prototype","apply","arguments","type","attributes","$el","win","doc","maxRange","val1","val2","val3","result","CLASSES","responsivePics","focalPoint","el","attachmentId","options","$responsivePics","$clickArea","self","data","init","defaultOptions","addInterfaceElements","focusInterface","saveButton","updateDimensionData","width","height","console","log","getData","ajax","url","ajaxurl","action","dataType","always","undefined","Error","err","updateStylePosition","updateStyleBackground","radius","position","clickPosition","state","active","updateStyle","highlight","a","backgroundImage","attr","backgroundSize","backgroundPosition","isSaving","sendImageCropDataByAjax","text","responsivePicsL10n","activate","disable","beforeSend","saving","msg","saved","success","tryAgain","myDefaultValue","fn","parseInt","each","initAttachment","length"],"mappings":"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","file":"focalpoint/admin-c2c6d46f.js","sourcesContent":["/* eslint-disable camelcase */ /* eslint-disable babel/camelcase */ /* eslint-disable no-underscore-dangle */ // eslint-disable-next-line no-unused-vars\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\n/* global __webpack_public_path__ */ // eslint-disable-next-line spaced-comment\n///<reference types=\"webpack-env\" />\n// We expect __webpack_public_path__ to be present, thanks to webpack\n// We are not using DOM in the typescript library, so let's just hack our way\n// through window\n// tslint:disable-next-line:no-any\n// We would override __webpack_public_path__ only if __WPACKIO__ webpack plugin is set\nif(__WPACKIO__){var path=(__WPACKIO__.appName+__WPACKIO__.outputPath).replace(/[^a-zA-Z0-9_-]/g,'');// eslint-disable-next-line no-global-assign\n__webpack_public_path__=window[\"__wpackIo\".concat(path)];}","(function($) {\n\t$(document).ready(() => {\n\t\tlet $imageFocal;\n\t\tlet $imageFocalWrapper;\n\t\tlet $imageFocalPoint;\n\t\tlet $imageFocalClickarea;\n\n\t\tlet _active = false;\n\t\tlet _hover = false;\n\t\tlet _move = false;\n\n\t\tlet offset = {\n\t\t\tx: 0,\n\t\t\ty: 0\n\t\t};\n\t\tlet position = {\n\t\t\tx: 0,\n\t\t\ty: 0\n\t\t};\n\t\tlet clickPosition = {\n\t\t\tx: 0,\n\t\t\ty: 0\n\t\t};\n\n\t\t/*\n\t\t * Init templates\n\t\t */\n\t\tconst initTemplates = element => {\n\t\t\t// Append focal point selector\n\t\t\tvar selectView   = wp.media.template('attachment-select-focal-point');\n\t\t\tvar selectParent = element.find('.thumbnail');\n\t\t\tvar selectImg    = element.find('.details-image');\n\n\t\t\tif (selectView) {\n\t\t\t\tselectParent.prepend(selectView);\n\t\t\t\t// Set image focal elements\n\t\t\t\t$imageFocal          = element.find('.image-focal');\n\t\t\t\t$imageFocalWrapper   = element.find('.image-focal__wrapper');\n\t\t\t\t$imageFocalPoint     = element.find('.image-focal__point');\n\t\t\t\t$imageFocalClickarea = element.find('.image-focal__clickarea');\n\t\t\t\tselectImg.prependTo($imageFocalWrapper);\n\t\t\t}\n\n\t\t\t// Append focal point save button\n\t\t\tvar saveView   = wp.media.template('attachment-save-focal-point');\n\t\t\tvar saveParent = element.find('.attachment-actions');\n\t\t\tif (saveView) {\n\t\t\t\tsaveParent.append(saveView);\n\t\t\t}\n\t\t};\n\n\t\tconst updateClickPosition = (t, e) => {\n\t\t\tconst pos = {\n\t\t\t\tx: 0,\n\t\t\t\ty: 0\n\t\t\t};\n\n\t\t\tif (e !== true) {\n\t\t\t\tconst o = offset;\n\n\t\t\t\tpos.x = t.pageX - o.x;\n\t\t\t\tpos.y = t.pageY - o.y;\n\t\t\t}\n\n\t\t\tclickPosition = pos;\n\t\t};\n\n\t\tconst startMove = (t, e) => {\n\t\t\tupdateClickPosition(t, e);\n\t\t\t// self.attachment.updateDimensionData();\n\t\t\t// self.focusInterface.updateDimensionData().updateClickPosition(t, e);\n\t\t\t// self.saveButton.highlight();\n\n\t\t\t$imageFocal.addClass('is-active');\n\n\t\t\t_move = true;\n\t\t\t_active = true;\n\t\t};\n\n\t\tconst move = e => {\n\t\t\tif (!_move) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\t// const a = {};\n\t\t\t// const offset = self.attachment.offset;\n\t\t\t// const pos = self.focusInterface.clickPosition;\n\n\t\t\t// a.x = e.pageX - offset.x - pos.x;\n\t\t\t// a.y = e.pageY - offset.y - pos.y;\n\t\t\t// a.x = maxRange(a.x, 0, self.attachment.width);\n\t\t\t// a.y = maxRange(a.y, 0, self.attachment.height);\n\n\t\t\t// self.attachment.focalPoint = {\n\t\t\t// \tx: a.x / self.attachment.width * 100,\n\t\t\t// \ty: a.y / self.attachment.height * 100\n\t\t\t// };\n\n\t\t\t// self.focusInterface.position = a;\n\t\t\t// self.focusInterface.updateStyle();\n\t\t};\n\n\t\tconst hover = val => {\n\t\t\t_hover = val;\n\t\t\t$imageFocal.toggleClass('is-hover', val);\n\t\t};\n\n\t\t/*\n\t\t * Init Focus Interface\n\t\t */\n\t\tconst initFocusInterface = (x, y) => {\n\t\t\t$imageFocalPoint.css({\n\t\t\t\tleft: `${x}%`,\n\t\t\t\ttop: `${y}%`,\n\t\t\t\tdisplay: 'block'\n\t\t\t});\n\n\t\t\t$imageFocalClickarea\n\t\t\t\t.on('mousedown', e => {\n\t\t\t\t\tif (e.which === 1) {\n\t\t\t\t\t\tstartMove(e, true).move(e);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t$imageFocalPoint\n\t\t\t\t.on('mousedown', e => {\n\t\t\t\t\tif (e.which === 1) {\n\t\t\t\t\t\tstartMove(e);\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.on('mouseenter', () => {\n\t\t\t\t\thover(true);\n\t\t\t\t})\n\t\t\t\t.on('mouseleave', () => {\n\t\t\t\t\thover(false);\n\t\t\t\t});\n\n\t\t\t$(window)\n\t\t\t\t.on('mouseup', e => {\n\t\t\t\t\tif (e.which === 1) {\n\t\t\t\t\t\t_move = false;\n\t\t\t\t\t\t_active = false;\n\t\t\t\t\t\t$imageFocal.removeClass('is-active');\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.on('mousemove', e => {\n\t\t\t\t\tmove(e);\n\t\t\t\t})\n\t\t\t\t.on('resize', () => {\n\t\t\t\t\t// updateDimensionData().updateStyle();\n\t\t\t\t});\n\t\t};\n\n\t\t/*\n\t\t * Init Focal Point\n\t\t */\n\t\tconst initFocalPoint = attachment => {\n\t\t\tconst { id } = attachment;\n\t\t\tconst compat = attachment.get('compat');\n\n\t\t\tif (compat.item) {\n\t\t\t\tconst focalPointX = $(compat.item).find('.compat-field-responsive_pics_focal_point_x input').val();\n\t\t\t\tconst focalPointY = $(compat.item).find('.compat-field-responsive_pics_focal_point_y input').val();\n\n\t\t\t\tinitFocusInterface(focalPointX, focalPointY);\n\t\t\t}\n\t\t};\n\n\t\t/*\n\t\t * Extend Attachment view\n\t\t */\n\t\tvar TwoColumn = wp.media.view.Attachment.Details.TwoColumn;\n\t\twp.media.view.Attachment.Details.TwoColumn = TwoColumn.extend({\n\t\t\tinitialize: function() {\n\t\t\t\t// Always make sure that our content is up to date.\n\t\t\t\tthis.model.on('change:compat', this.change, this);\n\t\t\t},\n\t\t\trender: function() {\n\t\t\t\t// Ensure that the main view is rendered.\n\t\t\t\twp.media.view.Attachment.prototype.render.apply(this, arguments);\n\t\t\t\t// Init focal point for images\n\t\t\t\tconst { type } = this.model.attributes;\n\t\t\t\tif (type === 'image') {\n\t\t\t\t\tinitTemplates(this.$el);\n\t\t\t\t\tinitFocalPoint(this.model);\n\t\t\t\t}\n\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tchange: function() {\n\t\t\t\t// Re-init focal point for images\n\t\t\t\tconst { type } = this.model.attributes;\n\t\t\t\tif (type === 'image') {\n\t\t\t\t\tinitFocalPoint(this.model);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t});\n})(jQuery);\n\n\n\n/* global jQuery, ajaxurl, responsivePicsL10n */\n(function($, win, doc) {\n\tfunction maxRange(val1, val2, val3) {\n\t\tlet result = val1;\n\n\t\tif (val1 < val2) {\n\t\t\tresult = val2;\n\t\t} else if (val1 > val3) {\n\t\t\tresult = val3;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tconst CLASSES = {\n\t\tIMAGE_FOCAL          : 'image-focal',\n\t\tIMAGE_FOCAL_WRAPPER  : 'image-focal__wrapper',\n\t\tIMAGE_FOCAL_IMG      : 'image-focal__img',\n\t\tIMAGE_FOCAL_POINT    : 'image-focal__point',\n\t\tIMAGE_FOCAL_CLICKAREA: 'image-focal__clickarea',\n\t\tIMAGE_FOCAL_BUTTON   : 'image-focal__button',\n\t\tBUTTON               : 'button',\n\t\tBUTTON_PRIMARY       : 'button-primary',\n\t\tBUTTON_DISABLED      : 'button-disabled'\n\t};\n\n\t$.responsivePics = $.responsivePics || {};\n\n\t$.responsivePics.focalPoint = function(el, attachmentId, options) {\n\t\tconst self = this;\n\n\t\tself.$el = $(el);\n\t\tself.el = el;\n\t\tself.$el.data('responsivePics.focalPoint', self);\n\n\t\tlet $responsivePics;\n\t\tlet $clickArea;\n\n\t\tself.init = function() {\n\t\t\tself.options = $.extend({}, $.responsivePics.focalPoint.defaultOptions, options);\n\n\t\t\tself.addInterfaceElements();\n\t\t\tself.attachment.init();\n\t\t\tself.focusInterface.init();\n\t\t\tself.saveButton.init();\n\n\t\t\t$(doc).on('resize', self.attachment.updateDimensionData);\n\t\t};\n\n\t\tself.addInterfaceElements = function() {\n\t\t\t// const $el = $('.edit-attachment-frame .attachment-media-view .details-image, .edit-attachment-frame .image-editor .imgedit-crop-wrap img');\n\n\t\t\t$responsivePics = $(`.${CLASSES.IMAGE_FOCAL}`);\n\t\t\t$clickArea = $(`.${CLASSES.IMAGE_FOCAL_CLICKAREA}`);\n\t\t};\n\n\t\tself.attachment = {\n\t\t\t$el   : false,\n\t\t\tid    : false,\n\t\t\twidth : false,\n\t\t\theight: false,\n\t\t\toffset: {\n\t\t\t\tx: false,\n\t\t\t\ty: false\n\t\t\t},\n\t\t\tfocalPoint: {\n\t\t\t\tx: 50,\n\t\t\t\ty: 50\n\t\t\t},\n\t\t\tinit() {\n\t\t\t\tconsole.log('init', attachmentId);\n\t\t\t\tself.attachment.$el = $(`.${CLASSES.IMAGE_FOCAL_IMG}`);\n\t\t\t\tself.attachment.id = attachmentId;\n\t\t\t\tself.attachment.getData();\n\t\t\t\tself.attachment.$el.on('load', () => {\n\t\t\t\t\tself.attachment.updateDimensionData();\n\t\t\t\t});\n\t\t\t},\n\t\t\tgetData() {\n\t\t\t\tconst attachment = {\n\t\t\t\t\t'id': self.attachment.id\n\t\t\t\t};\n\n\t\t\t\t$.ajax({\n\t\t\t\t\ttype: 'POST',\n\t\t\t\t\turl : ajaxurl,\n\t\t\t\t\tdata: {\n\t\t\t\t\t\taction: 'get_focal_point',\n\t\t\t\t\t\tattachment\n\t\t\t\t\t},\n\t\t\t\t\tdataType: 'json'\n\t\t\t\t}).always(result => {\n\t\t\t\t\tif (result['success'] === true && result['data'] && result['data']['focal_point']) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tif (result['data']['focal_point']['x'] === undefined || result['data']['focal_point']['y'] === undefined) {\n\t\t\t\t\t\t\t\tthrow new Error('no coordinates');\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tself.attachment.focalPoint = result['data']['focal_point'];\n\t\t\t\t\t\t} catch (err) {\n\t\t\t\t\t\t\tconsole.log(err);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tself.attachment.updateDimensionData();\n\t\t\t\t\tself.focusInterface.updateStylePosition();\n\t\t\t\t\tself.focusInterface.$el.css({\n\t\t\t\t\t\tdisplay: 'block'\n\t\t\t\t\t});\n\t\t\t\t\tself.focusInterface.updateDimensionData();\n\t\t\t\t\tself.focusInterface.updateStyleBackground();\n\t\t\t\t});\n\t\t\t},\n\t\t\tupdateDimensionData() {\n\t\t\t\tconst $el = self.attachment.$el;\n\n\t\t\t\tself.attachment.width = $el.width();\n\t\t\t\tself.attachment.height = $el.height();\n\t\t\t\tself.attachment.offset.x = $el.offset().left;\n\t\t\t\tself.attachment.offset.y = $el.offset().top;\n\t\t\t}\n\t\t};\n\n\t\tself.focusInterface = {\n\t\t\t$el   : false,\n\t\t\twidth : 0,\n\t\t\theight: 0,\n\t\t\tradius: 0,\n\t\t\toffset: {\n\t\t\t\tx: 0,\n\t\t\t\ty: 0\n\t\t\t},\n\t\t\tposition: {\n\t\t\t\tx: 0,\n\t\t\t\ty: 0\n\t\t\t},\n\t\t\tclickPosition: {\n\t\t\t\tx: 0,\n\t\t\t\ty: 0\n\t\t\t},\n\t\t\tstate: {\n\t\t\t\tmove  : false,\n\t\t\t\tactive: false,\n\t\t\t\thover : false\n\t\t\t},\n\t\t\tinit() {\n\t\t\t\tself.focusInterface.$el = $(`.${CLASSES.IMAGE_FOCAL_POINT}`);\n\n\t\t\t\t$clickArea.on('mousedown', e => {\n\t\t\t\t\tif (e.which === 1) {\n\t\t\t\t\t\tself.focusInterface.startMove(e, true).move(e);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tself.focusInterface.$el\n\t\t\t\t\t.on('mousedown', e => {\n\t\t\t\t\t\tif (e.which === 1) {\n\t\t\t\t\t\t\tself.focusInterface.startMove(e);\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\t.on('mouseenter', () => {\n\t\t\t\t\t\tself.focusInterface.hover(true);\n\t\t\t\t\t})\n\t\t\t\t\t.on('mouseleave', () => {\n\t\t\t\t\t\tself.focusInterface.hover(false);\n\t\t\t\t\t});\n\n\t\t\t\t$(win)\n\t\t\t\t\t.on('mouseup', e => {\n\t\t\t\t\t\tif (e.which === 1) {\n\t\t\t\t\t\t\tself.focusInterface.state.move = false;\n\t\t\t\t\t\t\tself.focusInterface.state.active = false;\n\t\t\t\t\t\t\t$responsivePics.removeClass('is-active');\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\t.on('mousemove', e => {\n\t\t\t\t\t\tself.focusInterface.move(e);\n\t\t\t\t\t})\n\t\t\t\t\t.on('resize', () => {\n\t\t\t\t\t\tself.focusInterface.updateDimensionData().updateStyle();\n\t\t\t\t\t});\n\t\t\t},\n\t\t\tstartMove(t, e) {\n\t\t\t\tself.attachment.updateDimensionData();\n\t\t\t\tself.focusInterface.updateDimensionData().updateClickPosition(t, e);\n\t\t\t\tself.saveButton.highlight();\n\n\t\t\t\t$responsivePics.addClass('is-active');\n\n\t\t\t\tself.focusInterface.state.move = true;\n\t\t\t\tself.focusInterface.state.active = true;\n\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tmove(e) {\n\t\t\t\tif (self.focusInterface.state.move === false) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst a = {};\n\t\t\t\tconst offset = self.attachment.offset;\n\t\t\t\tconst pos = self.focusInterface.clickPosition;\n\n\t\t\t\ta.x = e.pageX - offset.x - pos.x;\n\t\t\t\ta.y = e.pageY - offset.y - pos.y;\n\t\t\t\ta.x = maxRange(a.x, 0, self.attachment.width);\n\t\t\t\ta.y = maxRange(a.y, 0, self.attachment.height);\n\n\t\t\t\tself.attachment.focalPoint = {\n\t\t\t\t\tx: a.x / self.attachment.width * 100,\n\t\t\t\t\ty: a.y / self.attachment.height * 100\n\t\t\t\t};\n\n\t\t\t\tself.focusInterface.position = a;\n\t\t\t\tself.focusInterface.updateStyle();\n\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tupdateStyle() {\n\t\t\t\tself.focusInterface.updateStylePosition();\n\t\t\t\tself.focusInterface.updateStyleBackground();\n\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tupdateStylePosition() {\n\t\t\t\tself.focusInterface.$el.css({\n\t\t\t\t\tleft: `${self.attachment.focalPoint.x}%`,\n\t\t\t\t\ttop : `${self.attachment.focalPoint.y}%`\n\t\t\t\t});\n\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tupdateStyleBackground() {\n\t\t\t\tconst x = 0 - (self.focusInterface.position.x - self.focusInterface.radius);\n\t\t\t\tconst y = 0 - (self.focusInterface.position.y - self.focusInterface.radius);\n\n\t\t\t\tself.focusInterface.$el.css({\n\t\t\t\t\tbackgroundImage   : `url(\"${self.attachment.$el.attr('src')}\")`,\n\t\t\t\t\tbackgroundSize    : `${self.attachment.width}px ${self.attachment.height}px`,\n\t\t\t\t\tbackgroundPosition: `${x}px ${y}px `\n\t\t\t\t});\n\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tupdateClickPosition(t, e) {\n\t\t\t\tconst pos = {\n\t\t\t\t\tx: 0,\n\t\t\t\t\ty: 0\n\t\t\t\t};\n\n\t\t\t\tif (e !== true) {\n\t\t\t\t\tconst o = self.focusInterface.offset;\n\n\t\t\t\t\tpos.x = t.pageX - o.x;\n\t\t\t\t\tpos.y = t.pageY - o.y;\n\t\t\t\t}\n\n\t\t\t\tself.focusInterface.clickPosition = pos;\n\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tupdateDimensionData() {\n\t\t\t\tself.focusInterface.width = self.focusInterface.$el.width();\n\t\t\t\tself.focusInterface.height = self.focusInterface.$el.height();\n\n\t\t\t\tconst radius = self.focusInterface.width / 2;\n\n\t\t\t\tself.focusInterface.radius = radius;\n\n\t\t\t\tconst o = self.focusInterface.$el.offset();\n\n\t\t\t\tself.focusInterface.offset = {\n\t\t\t\t\tx: o.left + radius,\n\t\t\t\t\ty: o.top + radius\n\t\t\t\t};\n\n\t\t\t\tself.focusInterface.position = {\n\t\t\t\t\tx: self.attachment.focalPoint.x / 100 * self.attachment.width,\n\t\t\t\t\ty: self.attachment.focalPoint.y / 100 * self.attachment.height\n\t\t\t\t};\n\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\thover(val) {\n\t\t\t\tself.focusInterface.state.hover = val;\n\n\t\t\t\t$responsivePics.toggleClass('is-hover', val);\n\t\t\t}\n\t\t};\n\n\t\tself.saveButton = {\n\t\t\t$el     : false,\n\t\t\tisSaving: false,\n\t\t\tinit() {\n\t\t\t\tself.saveButton.$el = $(`.${CLASSES.IMAGE_FOCAL_BUTTON}`);\n\t\t\t\tself.saveButton.$el.on('click', self.sendImageCropDataByAjax);\n\t\t\t},\n\t\t\thighlight() {\n\t\t\t\tself.saveButton.$el\n\t\t\t\t\t.removeClass(CLASSES.BUTTON_DISABLED)\n\t\t\t\t\t.addClass(CLASSES.BUTTON_PRIMARY)\n\t\t\t\t\t.text(responsivePicsL10n.saveButton);\n\t\t\t},\n\t\t\tactivate() {\n\t\t\t\tself.saveButton.$el\n\t\t\t\t\t.removeClass(CLASSES.BUTTON_DISABLED)\n\t\t\t\t\t.removeClass(CLASSES.BUTTON_PRIMARY);\n\t\t\t},\n\t\t\tdisable() {\n\t\t\t\tself.saveButton.$el\n\t\t\t\t\t.removeClass(CLASSES.BUTTON_PRIMARY)\n\t\t\t\t\t.addClass(CLASSES.BUTTON_DISABLED);\n\t\t\t}\n\t\t};\n\n\t\tself.sendImageCropDataByAjax = function() {\n\t\t\tconst attachment = {\n\t\t\t\t'id'         : self.attachment.id,\n\t\t\t\t'focal_point': self.attachment.focalPoint\n\t\t\t};\n\n\t\t\t$.ajax({\n\t\t\t\ttype: 'POST',\n\t\t\t\turl : ajaxurl,\n\t\t\t\tdata: {\n\t\t\t\t\taction: 'set_focal_point',\n\t\t\t\t\tattachment\n\t\t\t\t},\n\t\t\t\tdataType: 'json',\n\t\t\t\tbeforeSend() {\n\t\t\t\t\tif (self.saveButton.isSaving === true) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\tself.saveButton.$el.text(responsivePicsL10n.saving);\n\t\t\t\t\tself.saveButton.disable();\n\t\t\t\t\tself.saveButton.isSaving = true;\n\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}).always(result => {\n\t\t\t\tlet msg = responsivePicsL10n.saved;\n\n\t\t\t\tif (result.success !== true) {\n\t\t\t\t\tself.saveButton.activate();\n\t\t\t\t\tmsg = responsivePicsL10n.tryAgain;\n\t\t\t\t}\n\n\t\t\t\tself.saveButton.$el.text(msg);\n\t\t\t\tself.saveButton.isSaving = false;\n\t\t\t});\n\t\t};\n\t};\n\n\t$.responsivePics.focalPoint.defaultOptions = {\n\t\tmyDefaultValue: ''\n\t};\n\n\t$.fn.initFocalPoint = function(id) {\n\t\tconsole.log('initFocalPoint', this, parseInt(id));\n\t\treturn this.each(function() {\n\t\t\tnew $.responsivePics.focalPoint(this, parseInt(id)).init();\n\t\t});\n\t};\n\n\t$.responsivePics.focalPoint.initAttachment = function(id) {\n\t\tconst $el = $('.attachment-details, .image-editor');\n\t\tif ($el.find('.details-image, .imgedit-crop-wrap img').length && !$('.image-focal').length) {\n\t\t\treturn $el.initFocalPoint(id);\n\t\t}\n\t};\n})(jQuery, window, document);\n"],"sourceRoot":""}