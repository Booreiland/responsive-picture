{"version":3,"sources":["webpack:///./node_modules/@wpackio/entrypoint/lib/index.js","webpack:///./assets/scripts/focalpoint.js"],"names":["path","replace","window","concat","jQuery","document","ready","TwoColumn","wp","media","view","Attachment","Details","extend","render","prototype","apply","this","arguments","focalPoint","template","console","log","$el","views","detach","append","model","toJSON","fetch","$","win","doc","maxRange","val1","val2","val3","result","CLASSES","responsivePics","el","attachmentId","options","$responsivePics","$clickArea","self","data","init","defaultOptions","addInterfaceElements","attachment","focusInterface","saveButton","on","updateDimensionData","id","width","height","offset","x","y","getData","ajax","type","url","ajaxurl","action","dataType","always","undefined","Error","err","updateStylePosition","css","display","updateStyleBackground","left","top","radius","position","clickPosition","state","move","active","hover","e","which","startMove","removeClass","updateStyle","t","updateClickPosition","highlight","addClass","a","pos","pageX","pageY","backgroundImage","attr","backgroundSize","backgroundPosition","o","val","toggleClass","isSaving","sendImageCropDataByAjax","text","responsivePicsL10n","activate","disable","beforeSend","saving","msg","saved","success","tryAgain","myDefaultValue","fn","initFocalPoint","parseInt","each","initAttachment","find","length"],"mappings":"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","file":"focalpoint/admin-e6182441.js","sourcesContent":["/* eslint-disable camelcase */ /* eslint-disable babel/camelcase */ /* eslint-disable no-underscore-dangle */ // eslint-disable-next-line no-unused-vars\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\n/* global __webpack_public_path__ */ // eslint-disable-next-line spaced-comment\n///<reference types=\"webpack-env\" />\n// We expect __webpack_public_path__ to be present, thanks to webpack\n// We are not using DOM in the typescript library, so let's just hack our way\n// through window\n// tslint:disable-next-line:no-any\n// We would override __webpack_public_path__ only if __WPACKIO__ webpack plugin is set\nif(__WPACKIO__){var path=(__WPACKIO__.appName+__WPACKIO__.outputPath).replace(/[^a-zA-Z0-9_-]/g,'');// eslint-disable-next-line no-global-assign\n__webpack_public_path__=window[\"__wpackIo\".concat(path)];}","/*\n * https://gist.github.com/sunnyratilal/5650341\n */\n(function($) {\n\t$(document).ready( function() {\n\t\tvar TwoColumn = wp.media.view.Attachment.Details.TwoColumn;\n\n\t\twp.media.view.Attachment.Details.TwoColumn = TwoColumn.extend({\n\t\t\trender: function(){\n\t\t\t\t// Ensure that the main attachment fields are rendered.\n\t\t\t\twp.media.view.Attachment.prototype.render.apply(this, arguments);\n\t\t\t\tvar focalPoint = wp.media.template('attachment-focal-point');\n\t\t\t\tconsole.log(this.$el, focalPoint);\n\n\t\t\t\t// Detach the views, append our custom fields, make sure that our data is fully updated and re-render the updated view.\n\t\t\t\tthis.views.detach();\n\t\t\t\tthis.$el.append(focalPoint(this.model.toJSON()));\n\t\t\t\tthis.model.fetch();\n\t\t\t\tthis.views.render();\n\t\t\t}\n\t\t});\n\t});\n})(jQuery);\n\n\n\n/* global jQuery, ajaxurl, responsivePicsL10n */\n(function($, win, doc) {\n\tfunction maxRange(val1, val2, val3) {\n\t\tlet result = val1;\n\n\t\tif (val1 < val2) {\n\t\t\tresult = val2;\n\t\t} else if (val1 > val3) {\n\t\t\tresult = val3;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tconst CLASSES = {\n\t\tIMAGE_FOCAL          : 'image-focal',\n\t\tIMAGE_FOCAL_WRAPPER  : 'image-focal__wrapper',\n\t\tIMAGE_FOCAL_IMG      : 'image-focal__img',\n\t\tIMAGE_FOCAL_POINT    : 'image-focal__point',\n\t\tIMAGE_FOCAL_CLICKAREA: 'image-focal__clickarea',\n\t\tIMAGE_FOCAL_BUTTON   : 'image-focal__button',\n\t\tBUTTON               : 'button',\n\t\tBUTTON_PRIMARY       : 'button-primary',\n\t\tBUTTON_DISABLED      : 'button-disabled'\n\t};\n\n\t$.responsivePics = $.responsivePics || {};\n\n\t$.responsivePics.focalPoint = function(el, attachmentId, options) {\n\t\tconst self = this;\n\n\t\tself.$el = $(el);\n\t\tself.el = el;\n\t\tself.$el.data('responsivePics.focalPoint', self);\n\n\t\tlet $responsivePics;\n\t\tlet $clickArea;\n\n\t\tself.init = function() {\n\t\t\tself.options = $.extend({}, $.responsivePics.focalPoint.defaultOptions, options);\n\n\t\t\tself.addInterfaceElements();\n\t\t\tself.attachment.init();\n\t\t\tself.focusInterface.init();\n\t\t\tself.saveButton.init();\n\n\t\t\t$(doc).on('resize', self.attachment.updateDimensionData);\n\t\t};\n\n\t\tself.addInterfaceElements = function() {\n\t\t\t// const $el = $('.edit-attachment-frame .attachment-media-view .details-image, .edit-attachment-frame .image-editor .imgedit-crop-wrap img');\n\n\t\t\t$responsivePics = $(`.${CLASSES.IMAGE_FOCAL}`);\n\t\t\t$clickArea = $(`.${CLASSES.IMAGE_FOCAL_CLICKAREA}`);\n\t\t};\n\n\t\tself.attachment = {\n\t\t\t$el   : false,\n\t\t\tid    : false,\n\t\t\twidth : false,\n\t\t\theight: false,\n\t\t\toffset: {\n\t\t\t\tx: false,\n\t\t\t\ty: false\n\t\t\t},\n\t\t\tfocalPoint: {\n\t\t\t\tx: 50,\n\t\t\t\ty: 50\n\t\t\t},\n\t\t\tinit() {\n\t\t\t\tconsole.log('init', attachmentId);\n\t\t\t\tself.attachment.$el = $(`.${CLASSES.IMAGE_FOCAL_IMG}`);\n\t\t\t\tself.attachment.id = attachmentId;\n\t\t\t\tself.attachment.getData();\n\t\t\t\tself.attachment.$el.on('load', () => {\n\t\t\t\t\tself.attachment.updateDimensionData();\n\t\t\t\t});\n\t\t\t},\n\t\t\tgetData() {\n\t\t\t\tconst attachment = {\n\t\t\t\t\t'id': self.attachment.id\n\t\t\t\t};\n\n\t\t\t\t$.ajax({\n\t\t\t\t\ttype: 'POST',\n\t\t\t\t\turl : ajaxurl,\n\t\t\t\t\tdata: {\n\t\t\t\t\t\taction: 'get_focal_point',\n\t\t\t\t\t\tattachment\n\t\t\t\t\t},\n\t\t\t\t\tdataType: 'json'\n\t\t\t\t}).always(result => {\n\t\t\t\t\tif (result['success'] === true && result['data'] && result['data']['focal_point']) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tif (result['data']['focal_point']['x'] === undefined || result['data']['focal_point']['y'] === undefined) {\n\t\t\t\t\t\t\t\tthrow new Error('no coordinates');\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tself.attachment.focalPoint = result['data']['focal_point'];\n\t\t\t\t\t\t} catch (err) {\n\t\t\t\t\t\t\tconsole.log(err);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tself.attachment.updateDimensionData();\n\t\t\t\t\tself.focusInterface.updateStylePosition();\n\t\t\t\t\tself.focusInterface.$el.css({\n\t\t\t\t\t\tdisplay: 'block'\n\t\t\t\t\t});\n\t\t\t\t\tself.focusInterface.updateDimensionData();\n\t\t\t\t\tself.focusInterface.updateStyleBackground();\n\t\t\t\t});\n\t\t\t},\n\t\t\tupdateDimensionData() {\n\t\t\t\tconst $el = self.attachment.$el;\n\n\t\t\t\tself.attachment.width = $el.width();\n\t\t\t\tself.attachment.height = $el.height();\n\t\t\t\tself.attachment.offset.x = $el.offset().left;\n\t\t\t\tself.attachment.offset.y = $el.offset().top;\n\t\t\t}\n\t\t};\n\n\t\tself.focusInterface = {\n\t\t\t$el   : false,\n\t\t\twidth : 0,\n\t\t\theight: 0,\n\t\t\tradius: 0,\n\t\t\toffset: {\n\t\t\t\tx: 0,\n\t\t\t\ty: 0\n\t\t\t},\n\t\t\tposition: {\n\t\t\t\tx: 0,\n\t\t\t\ty: 0\n\t\t\t},\n\t\t\tclickPosition: {\n\t\t\t\tx: 0,\n\t\t\t\ty: 0\n\t\t\t},\n\t\t\tstate: {\n\t\t\t\tmove  : false,\n\t\t\t\tactive: false,\n\t\t\t\thover : false\n\t\t\t},\n\t\t\tinit() {\n\t\t\t\tself.focusInterface.$el = $(`.${CLASSES.IMAGE_FOCAL_POINT}`);\n\n\t\t\t\t$clickArea.on('mousedown', e => {\n\t\t\t\t\tif (e.which === 1) {\n\t\t\t\t\t\tself.focusInterface.startMove(e, true).move(e);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tself.focusInterface.$el\n\t\t\t\t\t.on('mousedown', e => {\n\t\t\t\t\t\tif (e.which === 1) {\n\t\t\t\t\t\t\tself.focusInterface.startMove(e);\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\t.on('mouseenter', () => {\n\t\t\t\t\t\tself.focusInterface.hover(true);\n\t\t\t\t\t})\n\t\t\t\t\t.on('mouseleave', () => {\n\t\t\t\t\t\tself.focusInterface.hover(false);\n\t\t\t\t\t});\n\n\t\t\t\t$(win)\n\t\t\t\t\t.on('mouseup', e => {\n\t\t\t\t\t\tif (e.which === 1) {\n\t\t\t\t\t\t\tself.focusInterface.state.move = false;\n\t\t\t\t\t\t\tself.focusInterface.state.active = false;\n\t\t\t\t\t\t\t$responsivePics.removeClass('is-active');\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\t.on('mousemove', e => {\n\t\t\t\t\t\tself.focusInterface.move(e);\n\t\t\t\t\t})\n\t\t\t\t\t.on('resize', () => {\n\t\t\t\t\t\tself.focusInterface.updateDimensionData().updateStyle();\n\t\t\t\t\t});\n\t\t\t},\n\t\t\tstartMove(t, e) {\n\t\t\t\tself.attachment.updateDimensionData();\n\t\t\t\tself.focusInterface.updateDimensionData().updateClickPosition(t, e);\n\t\t\t\tself.saveButton.highlight();\n\n\t\t\t\t$responsivePics.addClass('is-active');\n\n\t\t\t\tself.focusInterface.state.move = true;\n\t\t\t\tself.focusInterface.state.active = true;\n\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tmove(e) {\n\t\t\t\tif (self.focusInterface.state.move === false) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst a = {};\n\t\t\t\tconst offset = self.attachment.offset;\n\t\t\t\tconst pos = self.focusInterface.clickPosition;\n\n\t\t\t\ta.x = e.pageX - offset.x - pos.x;\n\t\t\t\ta.y = e.pageY - offset.y - pos.y;\n\t\t\t\ta.x = maxRange(a.x, 0, self.attachment.width);\n\t\t\t\ta.y = maxRange(a.y, 0, self.attachment.height);\n\n\t\t\t\tself.attachment.focalPoint = {\n\t\t\t\t\tx: a.x / self.attachment.width * 100,\n\t\t\t\t\ty: a.y / self.attachment.height * 100\n\t\t\t\t};\n\n\t\t\t\tself.focusInterface.position = a;\n\t\t\t\tself.focusInterface.updateStyle();\n\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tupdateStyle() {\n\t\t\t\tself.focusInterface.updateStylePosition();\n\t\t\t\tself.focusInterface.updateStyleBackground();\n\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tupdateStylePosition() {\n\t\t\t\tself.focusInterface.$el.css({\n\t\t\t\t\tleft: `${self.attachment.focalPoint.x}%`,\n\t\t\t\t\ttop : `${self.attachment.focalPoint.y}%`\n\t\t\t\t});\n\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tupdateStyleBackground() {\n\t\t\t\tconst x = 0 - (self.focusInterface.position.x - self.focusInterface.radius);\n\t\t\t\tconst y = 0 - (self.focusInterface.position.y - self.focusInterface.radius);\n\n\t\t\t\tself.focusInterface.$el.css({\n\t\t\t\t\tbackgroundImage   : `url(\"${self.attachment.$el.attr('src')}\")`,\n\t\t\t\t\tbackgroundSize    : `${self.attachment.width}px ${self.attachment.height}px`,\n\t\t\t\t\tbackgroundPosition: `${x}px ${y}px `\n\t\t\t\t});\n\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tupdateClickPosition(t, e) {\n\t\t\t\tconst pos = {\n\t\t\t\t\tx: 0,\n\t\t\t\t\ty: 0\n\t\t\t\t};\n\n\t\t\t\tif (e !== true) {\n\t\t\t\t\tconst o = self.focusInterface.offset;\n\n\t\t\t\t\tpos.x = t.pageX - o.x;\n\t\t\t\t\tpos.y = t.pageY - o.y;\n\t\t\t\t}\n\n\t\t\t\tself.focusInterface.clickPosition = pos;\n\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tupdateDimensionData() {\n\t\t\t\tself.focusInterface.width = self.focusInterface.$el.width();\n\t\t\t\tself.focusInterface.height = self.focusInterface.$el.height();\n\n\t\t\t\tconst radius = self.focusInterface.width / 2;\n\n\t\t\t\tself.focusInterface.radius = radius;\n\n\t\t\t\tconst o = self.focusInterface.$el.offset();\n\n\t\t\t\tself.focusInterface.offset = {\n\t\t\t\t\tx: o.left + radius,\n\t\t\t\t\ty: o.top + radius\n\t\t\t\t};\n\n\t\t\t\tself.focusInterface.position = {\n\t\t\t\t\tx: self.attachment.focalPoint.x / 100 * self.attachment.width,\n\t\t\t\t\ty: self.attachment.focalPoint.y / 100 * self.attachment.height\n\t\t\t\t};\n\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\thover(val) {\n\t\t\t\tself.focusInterface.state.hover = val;\n\n\t\t\t\t$responsivePics.toggleClass('is-hover', val);\n\t\t\t}\n\t\t};\n\n\t\tself.saveButton = {\n\t\t\t$el     : false,\n\t\t\tisSaving: false,\n\t\t\tinit() {\n\t\t\t\tself.saveButton.$el = $(`.${CLASSES.IMAGE_FOCAL_BUTTON}`);\n\t\t\t\tself.saveButton.$el.on('click', self.sendImageCropDataByAjax);\n\t\t\t},\n\t\t\thighlight() {\n\t\t\t\tself.saveButton.$el\n\t\t\t\t\t.removeClass(CLASSES.BUTTON_DISABLED)\n\t\t\t\t\t.addClass(CLASSES.BUTTON_PRIMARY)\n\t\t\t\t\t.text(responsivePicsL10n.saveButton);\n\t\t\t},\n\t\t\tactivate() {\n\t\t\t\tself.saveButton.$el\n\t\t\t\t\t.removeClass(CLASSES.BUTTON_DISABLED)\n\t\t\t\t\t.removeClass(CLASSES.BUTTON_PRIMARY);\n\t\t\t},\n\t\t\tdisable() {\n\t\t\t\tself.saveButton.$el\n\t\t\t\t\t.removeClass(CLASSES.BUTTON_PRIMARY)\n\t\t\t\t\t.addClass(CLASSES.BUTTON_DISABLED);\n\t\t\t}\n\t\t};\n\n\t\tself.sendImageCropDataByAjax = function() {\n\t\t\tconst attachment = {\n\t\t\t\t'id'         : self.attachment.id,\n\t\t\t\t'focal_point': self.attachment.focalPoint\n\t\t\t};\n\n\t\t\t$.ajax({\n\t\t\t\ttype: 'POST',\n\t\t\t\turl : ajaxurl,\n\t\t\t\tdata: {\n\t\t\t\t\taction: 'set_focal_point',\n\t\t\t\t\tattachment\n\t\t\t\t},\n\t\t\t\tdataType: 'json',\n\t\t\t\tbeforeSend() {\n\t\t\t\t\tif (self.saveButton.isSaving === true) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\tself.saveButton.$el.text(responsivePicsL10n.saving);\n\t\t\t\t\tself.saveButton.disable();\n\t\t\t\t\tself.saveButton.isSaving = true;\n\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}).always(result => {\n\t\t\t\tlet msg = responsivePicsL10n.saved;\n\n\t\t\t\tif (result.success !== true) {\n\t\t\t\t\tself.saveButton.activate();\n\t\t\t\t\tmsg = responsivePicsL10n.tryAgain;\n\t\t\t\t}\n\n\t\t\t\tself.saveButton.$el.text(msg);\n\t\t\t\tself.saveButton.isSaving = false;\n\t\t\t});\n\t\t};\n\t};\n\n\t$.responsivePics.focalPoint.defaultOptions = {\n\t\tmyDefaultValue: ''\n\t};\n\n\t$.fn.initFocalPoint = function(id) {\n\t\tconsole.log('initFocalPoint', this, parseInt(id));\n\t\treturn this.each(function() {\n\t\t\tnew $.responsivePics.focalPoint(this, parseInt(id)).init();\n\t\t});\n\t};\n\n\t$.responsivePics.focalPoint.initAttachment = function(id) {\n\t\tconst $el = $('.attachment-details, .image-editor');\n\t\tif ($el.find('.details-image, .imgedit-crop-wrap img').length && !$('.image-focal').length) {\n\t\t\treturn $el.initFocalPoint(id);\n\t\t}\n\t};\n})(jQuery, window, document);\n"],"sourceRoot":""}